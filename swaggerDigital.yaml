openapi: 3.0.3
info:
  title: Digital Blog Practice
  description: |-
    Project Requirements
      - Build a digital newspaper system.
        - Scope 3 authority: ADMIN, USER, anonymous
        - Admin/user can login/logout, update their profile, password
        - User basic information: email, phone, firstname, lastname, dob
        - Register only for user
        - Dashboard for admin can view, edit, delete user; but user can’t
        - For articles, admin can add, edit, delete them; but users can only contribute and edit them
        - User/non-user can comment into each article

  contact:
    email: ndphuong-batch43@sdc.edu.vn
  version: 1.0.11
servers:
  - url: http://localhost:8000/api
tags:
  - name: auth
    description: API related to accesses that require authorization
  - name: unAuth
    description: The API involves accesses that do not require authorization
paths:
  /unAuth/registerUser:
    post:
      tags:
        - unAuth
      summary: Register user
      description: Register user to server
      operationId: registerUser
      requestBody:
        description: Register user object
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
        required: true
      responses:
        "200":
          description: user Registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "User registered successfully!!!"
                  resData:
                    $ref: "#/components/schemas/Logged"
        "400":
          description: Validation error in request body/user creation failed
        "422":
          description: User registration failed!
  /unAuth/logout:
    get:
      tags:
        - unAuth
      summary: Logout user
      description: ""
      operationId: logout user
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "You have successfully logged out !!!"

        "400":
          description: Validation error in request body
        "404":
          description: refreshToken not found
  /unAuth/refreshToken:
    get:
      tags:
        - unAuth
      summary: RefreshToken user
      description: ""
      operationId: RefreshToken user
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Update refreshToken successfully !!!"

        "400":
          description: No refreshToken found in cookie
        "500":
          description: Internal Server Error!!!
  /unAuth/changePassword:
    patch:
      tags:
        - unAuth
      summary: Change password user
      description: Change password user to server
      operationId: Change user password
      security:
        - BearerAuth: []
      requestBody:
        description: Change password user object
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChangePassword"
        required: true
      responses:
        "200":
          description: user Registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Changed password successfully!!!"
        "400":
          description: Validation error in request body/Current password is incorrect
        "404":
          description: User not found !!!
  /unAuth/updateProfile:
    put:
      tags:
        - unAuth
      summary: Update profile user
      description: Update profile user to server
      operationId: update user profile
      security:
        - BearerAuth: []
      requestBody:
        description: Update profile user object
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
        required: true
      responses:
        "200":
          description: user Registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "User registered successfully!!!"
                  resData:
                    $ref: "#/components/schemas/Logged"
        "400":
          description: Validation error in request body
        "404":
          description: No information found for User !!!
  /unAuth/login:
    post:
      tags:
        - unAuth
      summary: Login user
      description: Login user to server
      operationId: loginUser
      requestBody:
        description: Login user object
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Login"
        required: true
      responses:
        "200":
          description: User logged successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Logged successfully!!!"
                  resData:
                    $ref: "#/components/schemas/Logged"
        "400":
          description: Validation error in request body/user logged failed
        "404":
          description: This email is not in use yet
  /unAuth/{userId}:
    get:
      tags:
        - unAuth
      summary: Read profile user by user id
      description: ""
      operationId: getUserById
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: "The id that needs to be fetched. Use 60dc495b-1f6c-4e3a-807b-9318e4e370d8 for testing. "
          required: true
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Found information successfully !!!"
                  resData:
                    $ref: "#/components/schemas/User"

        "400":
          description: Validation error in request body
        "404":
          description: No information found for userId

  /unAuth/:
    get:
      tags:
        - unAuth
      summary: Read article
      description: Read article using pagination
      operationId: readArticle
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          required: false
          schema:
            type: integer
            minimum: 1
          description: The page number for pagination
        - in: query
          name: limit
          required: false
          schema:
            type: integer
            minimum: 1
          description: The maximum number of users per page
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Get data successfully !!!"
                  resData:
                    $ref: "#/components/schemas/User"

        "400":
          description: Validation error in request body

  /auth/saveUser:
    post:
      tags:
        - auth
      summary: Create new user
      description: Save user into server
      operationId: saveUser
      security:
        - BearerAuth: []
      requestBody:
        description: Create user object
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
        required: true
      responses:
        "200":
          description: user Created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "User Created successfully!!!"
                  resData:
                    $ref: "#/components/schemas/Logged"
        "400":
          description: Validation error in request body/user creation failed

  /auth/:
    get:
      tags:
        - auth
      summary: Read user
      description: Read user using pagination and search functionality
      operationId: readUser
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          required: false
          schema:
            type: integer
            minimum: 1
          description: The page number for pagination
        - in: query
          name: limit
          required: false
          schema:
            type: integer
            minimum: 1
          description: The maximum number of users per page
        - in: query
          name: searchText
          required: false
          schema:
            type: string
          description: Search text to filter users by email, first name, or last name
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Get data successfully !!!"
                  resData:
                    $ref: "#/components/schemas/User"

        "400":
          description: Validation error in request body

  /auth/user/{userId}:
    delete:
      tags:
        - auth
      summary: Delete user by user id
      description: ""
      operationId: deleteUserById
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: "The id that needs to be fetched. Use 5fa5e7e9-170d-4172-94e8-948e0e72bfa6 for testing. "
          required: true
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Delete user successfully !!! !!!"
        "404":
          description: Invalid userId

  /auth/activateUser/{userId}:
    patch:
      tags:
        - auth
      summary: Active user by user id
      description: Active user into profile by user id
      operationId: activateUser
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: "The id that needs to be fetched. Use 5fa5e7e9-170d-4172-94e8-948e0e72bfa6 for testing. "
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User has been activated
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "User has been activated !!!"
        "400":
          description: Validation error in request body
        "404":
          description: Not found user id !!!

  /auth/deactivateUser/{userId}:
    patch:
      tags:
        - auth
      summary: Deactivate user by user id
      description: Deactivate user into profile by user id
      operationId: deactivateUser
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: "The id that needs to be fetched. Use 5fa5e7e9-170d-4172-94e8-948e0e72bfa6 for testing. "
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User has been deactivated
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "User has been deactivated !!!"
        "400":
          description: Validation error in request body
        "404":
          description: Not found user id !!!

  /auth/saveArticle:
    post:
      tags:
        - auth
      summary: Create new article
      description: Create new article into server
      operationId: Create newArticle
      security:
        - BearerAuth: []
      requestBody:
        description: Create new article object
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Article"
        required: true
      responses:
        "200":
          description: article created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Article Created successfully!!!"
                  resData:
                    $ref: "#/components/schemas/Article"
        "400":
          description: Validation error in request body/Article creation failed

  /auth/article/{articleId}:
    delete:
      tags:
        - auth
      summary: Delete article by article id
      description: ""
      operationId: deleteArticleById
      security:
        - BearerAuth: []
      parameters:
        - name: articleId
          in: path
          description: "The id that needs to be fetched. Use 5fa5e7e9-170d-4172-94e8-948e0e72bfa6 for testing. "
          required: true
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      ok:
                        type: boolean
                        example: "true"
                      message:
                        type: string
                        example: "Delete article successfully !!! !!!"
        "404":
          description: Invalid articleId

components:
  schemas:
    User:
      type: object
      properties:
        firstName:
          type: string
          example: sin
        lastName:
          type: string
          example: lee
        email:
          type: string
          example: leesin@gmail.com
        phone:
          type: string
          example: 0362598631
        password:
          type: string
          example: leesin123
        dob:
          type: string
          example: 1999-01-01
    Article:
      type: object
      properties:
        title:
          type: string
          example: Dự báo thời tiết
        content:
          type: string
          example: Hôm nay thời tiết mát mẻ
        created_by:
          type: string
          example: leesin@gmail.com
    Comment:
      type: object
      properties:
        content:
          type: string
          example: Hôm nay thời tiết mát mẻ
        user_id:
          type: string
          example: 5fa5e7e9-170d-4172-94e8-948e0e72bfa6
        article_id:
          type: string
          example: 5fa5e7e9-170d-4172-94e8-948e0e72bfa7
    Login:
      type: object
      properties:
        email:
          type: string
          example: leesin@gmail.com
        password:
          type: string
          example: leesin123
    ChangePassword:
      type: object
      properties:
        currentPassword:
          type: string
          example: 000000
        newPassword:
          type: string
          example: 7777777
        newPasswordConfirm:
          type: string
          example: 7777777
    Logged:
      type: object
      properties:
        accessToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM0MzJlMTE5LTMyNWQtNDcwNi05NmUxLThhMWQ4ZjNiMTU0OSIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzA5MTEwMDI2LCJleHAiOjE3MDkxMTM2MjZ9.DZsR_JZj97AdM3agay7DPIPaLyYZBFdCoRXo0JTm0DU
        userData:
          type: object
          properties:
            id:
              type: string
              example: 6513f7df-e33b-4928-961e-4d5ee97557a9
            firstName:
              type: string
              example: sin
            lastName:
              type: string
              example: lee
            email:
              type: string
              example: leesin@gmail.com
            phone:
              type: string
              example: 0362598631
            dob:
              type: string
              example: 1999-01-01
            isBlocked:
              type: boolean
              example: false
            createdAt:
              type: string
              example: 2024-03-21T04:13:21.417Z
            updatedAt:
              type: string
              example: 2024-03-21T04:13:36.775Z
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
